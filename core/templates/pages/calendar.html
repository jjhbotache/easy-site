{% extends "base.html" %}
{% load static %}

{% block title %}{{ company.name }} - Calendario{% endblock %}
{% block icon %}
    <link rel="icon" href="{{ company.logo_small.url }}">
{% endblock %}

{% block content %}
<main class="flex flex-col bg-bg h-5/6 shadow-2xl">
    <!-- Encabezado -->
    <header class="bg-bg shadow-md p-4">
        <div class="flex justify-between items-center">
            <h1 class="text-2xl font-bold primary-dark-color">Mi Calendario</h1>
            <button id="addEventBtn" class="p-2  primary-bg bg-color rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50 flex items-center justify-evenly gap-2 ">
                <i class="fi fi-rr-plus"></i>
                Agregar Evento
            </button>
        </div>
        <hr class="primary-border border mt-2">
    </header>

    <!-- Contenido principal -->
    <main class="flex-grow overflow-auto">
        <!-- Vista de 3 días -->
        <div id="threeDayView">
            <div class="grid grid-cols-4 gap-1 bg-bg p-4">
                <!-- first row -->
                <div class="sticky top-0 bg-bg z-10">
                    <div class="flex justify-evenly items-center">
                        <button id="prevDaysBtn" class="p-2 primary-bg bg-color rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" title="Previos 3 días"> <i class="fi fi-rr-angle-left"></i> </button>
                        <button id="nextDaysBtn" class="p-2 primary-bg bg-color rounded-lg hover:bg-primary-dark focus:outline-none focus:ring-2 focus:ring-primary focus:ring-opacity-50" title="Próximos 3 días"> <i class="fi fi-rr-angle-right"></i> </button>
                    </div>
                </div>
                <div id="headerDay1"  class="sticky top-0 bg-bg z-10 text-center font-semibold primary-light-border border">Día 1</div>
                <div id="headerDay2"  class="sticky top-0 bg-bg z-10 text-center font-semibold primary-light-border border">Día 2</div>
                <div id="headerDay3"  class="sticky top-0 bg-bg z-10 text-center font-semibold primary-light-border border">Día 3</div>
                
                <!-- hours -->
            {% for i in calendar_config.hours %}
                <div class="text-right pr-2 primary-light-border border h-12 grid place-items-baseline">{{ i }}:00</div>
                <div id="day1Hour{{ i }}" class="primary-light-border border"></div>
                <div id="day2Hour{{ i }}" class="primary-light-border border"></div>
                <div id="day3Hour{{ i }}" class="primary-light-border border"></div>
            {% endfor %}

            </div>
        </div>
    </main>
</main>

<!-- Modal para agregar evento -->
<dialog id="eventModal" class="
primary-light-bg p-8 rounded-lg shadow-xl w-96 z-10
">
    <h2 class="text-2xl font-bold mb-4">Agregar Evento</h2>
    <form method="dialog">
        <div class="mb-4">
            <label for="eventTitle" class="block text-gray-700 text-sm font-bold mb-2">Título</label>
            <input type="text" id="eventTitle" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        </div>
        <div class="mb-4">
            <label for="eventDate" class="block text-gray-700 text-sm font-bold mb-2">Fecha</label>
            <input type="date" id="eventDate" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        </div>
        <div class="mb-4">
            <label for="eventTime" class="block text-gray-700 text-sm font-bold mb-2">Hora</label>
            <input type="time" id="eventTime" class="shadow appearance-none border rounded w-full py-2 px-3 text-gray-700 leading-tight focus:outline-none focus:shadow-outline">
        </div>
        <div class="flex items-center justify-between">
            <button type="submit" class="bg-primary hover:bg-primary-dark text-bg font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Guardar</button>
            <button type="button" id="closeModalBtn" class="bg-gray-300 hover:bg-gray-400 primary-color font-bold py-2 px-4 rounded focus:outline-none focus:shadow-outline">Cancelar</button>
        </div>
    </form>
</dialog>

<script>
    // Lógica para mostrar/ocultar el modal
    const addEventBtn = document.getElementById('addEventBtn');
    const eventModal = document.getElementById('eventModal');
    const closeModalBtn = document.getElementById('closeModalBtn');

    addEventBtn.addEventListener('click', () => {
        eventModal.showModal();
    });

    closeModalBtn.addEventListener('click', () => {
        eventModal.close();
    });

    // Mostrar la vista de 3 días por defecto
    const threeDayView = document.getElementById('threeDayView');
    threeDayView.classList.remove('hidden');
</script>
{% endblock content %}